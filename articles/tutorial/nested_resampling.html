<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Nested Resampling â€¢ mlr</title>
<!-- favicons --><link rel="icon" type="image/png" sizes="16x16" href="../../favicon-16x16.png">
<link rel="icon" type="image/png" sizes="32x32" href="../../favicon-32x32.png">
<link rel="apple-touch-icon" type="image/png" sizes="180x180" href="../../apple-touch-icon.png">
<link rel="apple-touch-icon" type="image/png" sizes="120x120" href="../../apple-touch-icon-120x120.png">
<link rel="apple-touch-icon" type="image/png" sizes="76x76" href="../../apple-touch-icon-76x76.png">
<link rel="apple-touch-icon" type="image/png" sizes="60x60" href="../../apple-touch-icon-60x60.png">
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.3.7/journal/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha384-Tc5IQib027qvyjSMfHjOMaLkfuWVxZxUPnCJA7l2mCWNIpG9mGCD8wGNIcPD7Txa" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/all.min.css" integrity="sha256-PbSmjxuVAzJ6FPvNYsrXygfGhNJYyZ2GktDbkMBqQZg=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.11.1/css/v4-shims.min.css" integrity="sha256-A6jcAdwFD48VMjlI3GDxUd+eCQa7/KWy6G9oe/ovaPA=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../../pkgdown.css" rel="stylesheet">
<link href="../../extra.css" rel="stylesheet">
<script src="../../pkgdown.js"></script><!-- docsearch --><script src="../../docsearch.js"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.css" integrity="sha256-QOSRU/ra9ActyXkIBbiIB144aDBdtvXBcNc3OTNuX/Q=" crossorigin="anonymous">
<link href="../../docsearch.css" rel="stylesheet">
<script src="https://cdnjs.cloudflare.com/ajax/libs/mark.js/8.11.1/jquery.mark.min.js" integrity="sha256-4HLtjeVgH0eIB3aZ9mLYF6E8oU5chNdjU6p6rrXpl9U=" crossorigin="anonymous"></script><meta property="og:title" content="Nested Resampling">
<meta property="og:description" content="">
<meta property="og:image" content="https://mlr.mlr-org.com/logo.png">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>

      <div class="navbar-brand-container">
        <a href="https://mlr-org.com"><img src="https://raw.githubusercontent.com/mlr-org/mlr3/master/man/figures/logo.png" id="hexlogo" alt="mlr-org"></a>
        <a class="navbar-brand" href="../../index.html">mlr <small>v2.17.1</small></a>
      </div>
    </div>
    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav navbar-right">
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Basics
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/task.html">Task</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learner.html">Learner</a>
    </li>
    <li>
      <a href="../../articles/tutorial/train.html">Train</a>
    </li>
    <li>
      <a href="../../articles/tutorial/predict.html">Predict</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/preproc.html">Preprocessing</a>
    </li>
    <li>
      <a href="../../articles/tutorial/tune.html">Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/resample.html">Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/benchmark_experiments.html">Benchmarking</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/parallelization.html">Parallelization</a>
    </li>
    <li>
      <a href="../../articles/tutorial/performance.html">Performance</a>
    </li>
    <li>
      <a href="../../articles/tutorial/visualization.html">Visualization</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/usecase_regression.html">Use case - Regression</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Advanced
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/configureMlr.html">mlr Configuration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/wrapper.html">Wrapped Learners</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/impute.html">Imputation</a>
    </li>
    <li>
      <a href="../../articles/tutorial/bagging.html">Generic Bagging</a>
    </li>
    <li>
      <a href="../../articles/tutorial/advanced_tune.html">Advanced Tuning</a>
    </li>
    <li>
      <a href="../../articles/tutorial/feature_selection.html">Feature Selection/Filtering</a>
    </li>
    <li>
      <a href="../../articles/tutorial/nested_resampling.html">Nested Resampling</a>
    </li>
    <li>
      <a href="../../articles/tutorial/over_and_undersampling.html">Imbalanced Classification Problems</a>
    </li>
    <li>
      <a href="../../articles/tutorial/roc_analysis.html">ROC Analysis and Performance Curves</a>
    </li>
    <li>
      <a href="../../articles/tutorial/learning_curve.html">Learning Curve Analysis</a>
    </li>
    <li>
      <a href="../../articles/tutorial/partial_dependence.html">Partial Dependence Plots</a>
    </li>
    <li>
      <a href="../../articles/tutorial/classifier_calibration.html">Classifier Calibration</a>
    </li>
    <li>
      <a href="../../articles/tutorial/hyperpar_tuning_effects.html">Hyperparameter Tuning Effects</a>
    </li>
    <li>
      <a href="../../articles/tutorial/out_of_bag_predictions.html">Out-of-Bag Predictions</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/multilabel.html">Multilabel Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/cost_sensitive_classif.html">Cost-Sensitive Classification</a>
    </li>
    <li>
      <a href="../../articles/tutorial/handling_of_spatial_data.html">Spatial Data</a>
    </li>
    <li>
      <a href="../../articles/tutorial/functional_data.html">Functional Data</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Extending
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/create_learner.html">Create Custom Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_measure.html">Create Custom Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_imputation.html">Create Custom Imputation Methods</a>
    </li>
    <li>
      <a href="../../articles/tutorial/create_filter.html">Create Custom Filters</a>
    </li>
  </ul>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Appendix
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../../articles/tutorial/example_tasks.html">Integrated Tasks</a>
    </li>
    <li>
      <a href="../../articles/tutorial/integrated_learners.html">Integrated Learners</a>
    </li>
    <li>
      <a href="../../articles/tutorial/measures.html">Integrated Measures</a>
    </li>
    <li>
      <a href="../../articles/tutorial/filter_methods.html">Integrated Filter Methods</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../articles/tutorial/mlr_publications.html">mlr Publications</a>
    </li>
    <li>
      <a href="https://github.com/mlr-org/mlr-outreach">Talks, Videos and Workshops</a>
    </li>
    <li class="divider">
    <li>
      <a href="https://mlrmbo.mlr-org.com">mlrMBO</a>
    </li>
    <li>
      <a href="https://https://mlrcpo.mlr-org.com">mlrCPO</a>
    </li>
    <li>
      <a href="https://jakob-r.de/mlrHyperopt/index.html">mlrHyperopt</a>
    </li>
    <li>
      <a href="http://openml.github.io/openml-r/">OpenML</a>
    </li>
    <li class="divider">
    <li>
      <a href="../../news/index.html">Changelog</a>
    </li>
  </ul>
</li>
<li>
  <a href="../../reference/index.html">Reference</a>
</li>
        <li>
  <a href="https://github.com/mlr-org/mlr">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="https://lmmisld-lmu-stats-slds.srv.mwn.de/mlr_invite/">
    <span class="fa fa fa fa-comments"></span>
     
  </a>
</li>
<li>
  <a href="https://stackoverflow.com/questions/tagged/mlr">
    <span class="fab fa fab fa-stack-overflow"></span>
     
  </a>
</li>
<li>
  <a href="https://mlr-org.com/">
    <span class="fa fa-rss"></span>
     
  </a>
</li>
      </ul>
<form class="navbar-form navbar-right docsearch" role="search">
        <div class="form-group">
          <input type="search" class="form-control" name="search-input" id="search-input" placeholder="Search..." aria-label="Search for..." autocomplete="off">
</div>
      </form>
      
    </div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Nested Resampling</h1>
            
      
      <small class="dont-index">Source: <a href="https://github.com/mlr-org/mlr/blob/master/vignettes/tutorial/nested_resampling.Rmd"><code>vignettes/tutorial/nested_resampling.Rmd</code></a></small>
      <div class="hidden name"><code>nested_resampling.Rmd</code></div>

    </div>

    
    
<p>In order to obtain honest performance estimates for a learner all parts of the model building like preprocessing and model selection steps should be included in the resampling, i.e., repeated for every pair of training/test data. For steps that themselves require resampling like parameter <a href="tune.html" target="_blank">tuning</a> or <a href="feature_selection.html" target="_blank">feature selection</a> (via the wrapper approach) this results in two nested resampling loops.</p>
<div class="figure" style="text-align: center">
<img src="https://raw.githubusercontent.com/pat-s/mlr/master/vignettes/tutorial/devel/pdf/img/nested_resampling.png" alt="Nested Resampling Figure" width="600px"><p class="caption">
Nested Resampling Figure
</p>
</div>
<p>The graphic above illustrates nested resampling for parameter tuning with 3-fold cross-validation in the outer and 4-fold cross-validation in the inner loop.</p>
<p>In the outer resampling loop, we have three pairs of training/test sets. On each of these outer training sets parameter tuning is done, thereby executing the inner resampling loop. This way, we get one set of selected hyperparameters for each outer training set. Then the learner is fitted on each outer training set using the corresponding selected hyperparameters and its performance is evaluated on the outer test sets.</p>
<p>In <code>mlr</code>, you can get nested resampling for free without programming any looping by using the <a href="wrapper.html" target="_blank">wrapper functionality</a>. This works as follows:</p>
<ol style="list-style-type: decimal">
<li>Generate a wrapped Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) via function <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code> or <code><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper()</a></code>. Specify the inner resampling strategy using their <code>resampling</code> argument.</li>
<li>Call function <code><a href="../../reference/resample.html">resample()</a></code> (see also the section about <a href="resample.html" target="_blank">resampling</a> and pass the outer resampling strategy to its <code>resampling</code> argument.</li>
</ol>
<p>You can freely combine different inner and outer resampling strategies.</p>
<p>The outer strategy can be a resample description <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>)) or a resample instance (<code><a href="../../reference/makeResampleInstance.html">makeResampleInstance()</a></code>)). A common setup is prediction and performance evaluation on a fixed outer test set. This can be achieved by using function <code><a href="../../reference/makeFixedHoldoutInstance.html">makeFixedHoldoutInstance()</a></code> to generate the outer resample instance<code>(</code>makeResampleInstance()`).</p>
<p>The inner resampling strategy should preferably be a <code>ResampleDesc</code> (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>), as the sizes of the outer training sets might differ. Per default, the inner resample description is instantiated once for every outer training set. This way during tuning/feature selection all parameter or feature sets are compared on the same inner training/test sets to reduce variance. You can also turn this off using the <code>same.resampling.instance</code> argument of <code>makeTuneControl*</code> (<code><a href="../../reference/TuneControl.html">TuneControl()</a></code>) or <code>makeFeatSelControl*</code> (<code><a href="../../reference/FeatSelControl.html">FeatSelControl()</a></code>).</p>
<p>Nested resampling is computationally expensive. For this reason in the examples shown below we use relatively small search spaces and a low number of resampling iterations. In practice, you normally have to increase both. As this is computationally intensive you might want to have a look at section <a href="parallelization.html" target="_blank">parallelization</a>.</p>
<div id="tuning" class="section level1">
<h1 class="hasAnchor">
<a href="#tuning" class="anchor"></a>Tuning</h1>
<p>As you might recall from the tutorial page about <a href="tune.html" target="_blank">tuning</a>, you need to define a search space by function <code><a href="https://paramhelpers.mlr-org.com/reference/makeParamSet.html">ParamHelpers::makeParamSet()</a></code>, a search strategy by <code>makeTuneControl*</code>(<code><a href="../../reference/TuneControl.html">TuneControl()</a></code>), and a method to evaluate hyperparameter settings (i.e., the inner resampling strategy and a performance measure).</p>
<p>Below is a classification example. We evaluate the performance of a support vector machine (<code><a href="https://rdrr.io/pkg/kernlab/man/ksvm.html">kernlab::ksvm()</a></code>) with tuned cost parameter <code>C</code> and RBF kernel parameter <code>sigma</code>. We use 3-fold cross-validation in the outer and subsampling with 2 iterations in the inner loop. For tuing a grid search is used to find the hyperparameters with lowest error rate (<a href="measures.html" target="_blank">mmce</a> is the default measure for classification). The wrapped Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) is generated by calling <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code>.</p>
<p>Note that in practice the parameter set should be larger. A common recommendation is <code>2^(-12:12)</code> for both <code>C</code> and <code>sigma</code>.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1"></a><span class="co"># Tuning in inner resampling loop</span></span>
<span id="cb1-2"><a href="#cb1-2"></a>ps =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb1-3"><a href="#cb1-3"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"C"</span>, <span class="dt">values =</span> <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>)),</span>
<span id="cb1-4"><a href="#cb1-4"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"sigma"</span>, <span class="dt">values =</span> <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">2</span><span class="op">:</span><span class="dv">2</span>))</span>
<span id="cb1-5"><a href="#cb1-5"></a>)</span>
<span id="cb1-6"><a href="#cb1-6"></a>ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</span>
<span id="cb1-7"><a href="#cb1-7"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</span>
<span id="cb1-8"><a href="#cb1-8"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(<span class="st">"classif.ksvm"</span>, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-9"><a href="#cb1-9"></a></span>
<span id="cb1-10"><a href="#cb1-10"></a><span class="co"># Outer resampling loop</span></span>
<span id="cb1-11"><a href="#cb1-11"></a>outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb1-12"><a href="#cb1-12"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(lrn, iris.task, <span class="dt">resampling =</span> outer, <span class="dt">extract =</span> getTuneResult, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb1-13"><a href="#cb1-13"></a></span>
<span id="cb1-14"><a href="#cb1-14"></a>r</span>
<span id="cb1-15"><a href="#cb1-15"></a></span>
<span id="cb1-16"><a href="#cb1-16"></a><span class="co">## Resample Result</span></span>
<span id="cb1-17"><a href="#cb1-17"></a><span class="co">## Task: iris-example</span></span>
<span id="cb1-18"><a href="#cb1-18"></a><span class="co">## Learner: classif.ksvm.tuned</span></span>
<span id="cb1-19"><a href="#cb1-19"></a><span class="co">## Aggr perf: mmce.test.mean=0.0400000</span></span>
<span id="cb1-20"><a href="#cb1-20"></a><span class="co">## Runtime: 5.50584</span></span></code></pre></div>
<p>You can obtain the error rates on the 3 outer test sets by:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1"></a>r<span class="op">$</span>measures.test</span>
<span id="cb2-2"><a href="#cb2-2"></a><span class="co">##   iter mmce</span></span>
<span id="cb2-3"><a href="#cb2-3"></a><span class="co">## 1    1 0.06</span></span>
<span id="cb2-4"><a href="#cb2-4"></a><span class="co">## 2    2 0.04</span></span>
<span id="cb2-5"><a href="#cb2-5"></a><span class="co">## 3    3 0.02</span></span></code></pre></div>
<div id="accessing-the-tuning-result" class="section level2">
<h2 class="hasAnchor">
<a href="#accessing-the-tuning-result" class="anchor"></a>Accessing the tuning result</h2>
<p>We have kept the results of the tuning for further evaluations. For example one might want to find out, if the best obtained configurations vary for the different outer splits. As storing entire models may be expensive (but possible by setting <code>models = TRUE</code>) we used the <code>extract</code> option of <code><a href="../../reference/resample.html">resample()</a></code>. Function <code><a href="../../reference/getTuneResult.html">getTuneResult()</a></code> returns, among other things, the optimal hyperparameter values and the optimization path (<code><a href="https://paramhelpers.mlr-org.com/reference/OptPath.html">ParamHelpers::OptPath()</a></code>) for each iteration of the outer resampling loop. Note that the performance values shown when printing <code>r$extract</code> are the aggregated performances resulting from inner resampling on the outer training set for the best hyperparameter configurations (not to be confused with <code>r$measures.test</code> shown above).</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1"></a>r<span class="op">$</span>extract</span>
<span id="cb3-2"><a href="#cb3-2"></a><span class="co">## [[1]]</span></span>
<span id="cb3-3"><a href="#cb3-3"></a><span class="co">## Tune result:</span></span>
<span id="cb3-4"><a href="#cb3-4"></a><span class="co">## Op. pars: C=1; sigma=0.5</span></span>
<span id="cb3-5"><a href="#cb3-5"></a><span class="co">## mmce.test.mean=0.0294118</span></span>
<span id="cb3-6"><a href="#cb3-6"></a><span class="co">## </span></span>
<span id="cb3-7"><a href="#cb3-7"></a><span class="co">## [[2]]</span></span>
<span id="cb3-8"><a href="#cb3-8"></a><span class="co">## Tune result:</span></span>
<span id="cb3-9"><a href="#cb3-9"></a><span class="co">## Op. pars: C=2; sigma=0.25</span></span>
<span id="cb3-10"><a href="#cb3-10"></a><span class="co">## mmce.test.mean=0.0294118</span></span>
<span id="cb3-11"><a href="#cb3-11"></a><span class="co">## </span></span>
<span id="cb3-12"><a href="#cb3-12"></a><span class="co">## [[3]]</span></span>
<span id="cb3-13"><a href="#cb3-13"></a><span class="co">## Tune result:</span></span>
<span id="cb3-14"><a href="#cb3-14"></a><span class="co">## Op. pars: C=2; sigma=0.25</span></span>
<span id="cb3-15"><a href="#cb3-15"></a><span class="co">## mmce.test.mean=0.0147059</span></span>
<span id="cb3-16"><a href="#cb3-16"></a></span>
<span id="cb3-17"><a href="#cb3-17"></a><span class="kw"><a href="https://rdrr.io/r/base/names.html">names</a></span>(r<span class="op">$</span>extract[[<span class="dv">1</span>]])</span>
<span id="cb3-18"><a href="#cb3-18"></a><span class="co">## [1] "learner"    "control"    "x"          "y"          "resampling"</span></span>
<span id="cb3-19"><a href="#cb3-19"></a><span class="co">## [6] "threshold"  "opt.path"</span></span></code></pre></div>
<p>We can compare the optimal parameter settings obtained in the 3 resampling iterations. As you can see, the optimal configuration usually depends on the data. You may be able to identify a <em>range</em> of parameter settings that achieve good performance though, e.g., the values for <code>C</code> should be at least 1 and the values for <code>sigma</code> should be between 0 and 1.</p>
<p>With function <code><a href="../../reference/getNestedTuneResultsOptPathDf.html">getNestedTuneResultsOptPathDf()</a></code> you can extract the optimization paths for the 3 outer cross-validation iterations for further inspection and analysis. These are stacked in one <code>data.frame</code> with column <code>iter</code> indicating the resampling iteration.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a>opt.paths =<span class="st"> </span><span class="kw"><a href="../../reference/getNestedTuneResultsOptPathDf.html">getNestedTuneResultsOptPathDf</a></span>(r)</span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(opt.paths, <span class="dv">10</span>)</span>
<span id="cb4-3"><a href="#cb4-3"></a></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">##       C sigma mmce.test.mean dob eol error.message exec.time iter</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">## 1  0.25  0.25     0.10294118   1  NA          &lt;NA&gt;     1.463    1</span></span>
<span id="cb4-6"><a href="#cb4-6"></a><span class="co">## 2   0.5  0.25     0.11764706   2  NA          &lt;NA&gt;     0.036    1</span></span>
<span id="cb4-7"><a href="#cb4-7"></a><span class="co">## 3     1  0.25     0.07352941   3  NA          &lt;NA&gt;     0.043    1</span></span>
<span id="cb4-8"><a href="#cb4-8"></a><span class="co">## 4     2  0.25     0.07352941   4  NA          &lt;NA&gt;     0.040    1</span></span>
<span id="cb4-9"><a href="#cb4-9"></a><span class="co">## 5     4  0.25     0.08823529   5  NA          &lt;NA&gt;     0.042    1</span></span>
<span id="cb4-10"><a href="#cb4-10"></a><span class="co">## 6  0.25   0.5     0.13235294   6  NA          &lt;NA&gt;     0.041    1</span></span>
<span id="cb4-11"><a href="#cb4-11"></a><span class="co">## 7   0.5   0.5     0.07352941   7  NA          &lt;NA&gt;     0.043    1</span></span>
<span id="cb4-12"><a href="#cb4-12"></a><span class="co">## 8     1   0.5     0.07352941   8  NA          &lt;NA&gt;     0.042    1</span></span>
<span id="cb4-13"><a href="#cb4-13"></a><span class="co">## 9     2   0.5     0.07352941   9  NA          &lt;NA&gt;     0.037    1</span></span>
<span id="cb4-14"><a href="#cb4-14"></a><span class="co">## 10    4   0.5     0.10294118  10  NA          &lt;NA&gt;     0.042    1</span></span></code></pre></div>
<p>Below we visualize the <code>opt.path</code>s for the 3 outer resampling iterations.</p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1"></a>g =<span class="st"> </span><span class="kw">ggplot</span>(opt.paths, <span class="kw">aes</span>(<span class="dt">x =</span> C, <span class="dt">y =</span> sigma, <span class="dt">fill =</span> mmce.test.mean))</span>
<span id="cb5-2"><a href="#cb5-2"></a>g <span class="op">+</span><span class="st"> </span><span class="kw">geom_tile</span>() <span class="op">+</span><span class="st"> </span><span class="kw">facet_wrap</span>(<span class="op">~</span><span class="st"> </span>iter)</span></code></pre></div>
<p><img src="nested_resampling_files/figure-html/unnamed-chunk-10-1.png" width="700"></p>
<p>Another useful function is <code><a href="../../reference/getNestedTuneResultsX.html">getNestedTuneResultsX()</a></code>, which extracts the best found hyperparameter settings for each outer resampling iteration.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1"></a><span class="kw"><a href="../../reference/getNestedTuneResultsX.html">getNestedTuneResultsX</a></span>(r)</span>
<span id="cb6-2"><a href="#cb6-2"></a><span class="co">##   C sigma</span></span>
<span id="cb6-3"><a href="#cb6-3"></a><span class="co">## 1 1  0.50</span></span>
<span id="cb6-4"><a href="#cb6-4"></a><span class="co">## 2 2  0.25</span></span>
<span id="cb6-5"><a href="#cb6-5"></a><span class="co">## 3 2  0.25</span></span></code></pre></div>
<p>You can furthermore access the resampling indices of the inner level using <code><a href="../../reference/getResamplingIndices.html">getResamplingIndices()</a></code> if you used either <code>extract = getTuneResult</code> or <code>extract = getFeatSelResult</code> in the <code><a href="../../reference/resample.html">resample()</a></code> call:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="kw"><a href="../../reference/getResamplingIndices.html">getResamplingIndices</a></span>(r, <span class="dt">inner =</span> <span class="ot">TRUE</span>)</span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">## [[1]]</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">## [[1]]$train.inds</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">## [[1]]$train.inds[[1]]</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">##  [1] 122 139 148  93  60  28 146 141 126   1  38 117  10 124 129  34 101  36  91</span></span>
<span id="cb7-6"><a href="#cb7-6"></a><span class="co">## [20]   2  99  33  42  61  51  87  96  54   7 132 115 113  32 150  41  40  64  69</span></span>
<span id="cb7-7"><a href="#cb7-7"></a><span class="co">## [39]  12 110 112 106  31  78 109 102   9  44  84 104  56 147  86 130 123 105 125</span></span>
<span id="cb7-8"><a href="#cb7-8"></a><span class="co">## [58]  70 133 135 142  58 128 111  16  55</span></span>
<span id="cb7-9"><a href="#cb7-9"></a><span class="co">## </span></span>
<span id="cb7-10"><a href="#cb7-10"></a><span class="co">## [[1]]$train.inds[[2]]</span></span>
<span id="cb7-11"><a href="#cb7-11"></a><span class="co">##  [1]  36 136 118  93 123   2 117  75  33 109  98  62 116 144  56 150  28   1  82</span></span>
<span id="cb7-12"><a href="#cb7-12"></a><span class="co">## [20] 115  20  86 125  29  14  44  11  17  54 133  91  60  18  99  73 104  37 132</span></span>
<span id="cb7-13"><a href="#cb7-13"></a><span class="co">## [39]   9   7  61  68  87  65 106  50 130 147  16  38 114 139  12 145  70 124 134</span></span>
<span id="cb7-14"><a href="#cb7-14"></a><span class="co">## [58] 146  58  42  55  31  74  77  26 148</span></span>
<span id="cb7-15"><a href="#cb7-15"></a><span class="co">## </span></span>
<span id="cb7-16"><a href="#cb7-16"></a><span class="co">## </span></span>
<span id="cb7-17"><a href="#cb7-17"></a><span class="co">## [[1]]$test.inds</span></span>
<span id="cb7-18"><a href="#cb7-18"></a><span class="co">## [[1]]$test.inds[[1]]</span></span>
<span id="cb7-19"><a href="#cb7-19"></a><span class="co">##  [1]  73  20  90  13  80  68  77  14  26 145  11  37 118 103 116  62 134  29  27</span></span>
<span id="cb7-20"><a href="#cb7-20"></a><span class="co">## [20]  98  65  30  18 100  82 144  22  50  74  17   5  75 114 136</span></span>
<span id="cb7-21"><a href="#cb7-21"></a><span class="co">## </span></span>
<span id="cb7-22"><a href="#cb7-22"></a><span class="co">## [[1]]$test.inds[[2]]</span></span>
<span id="cb7-23"><a href="#cb7-23"></a><span class="co">##  [1] 141  69  90  41  34 112  13  80 103  84  32 110 142  27 122  30 135 113 102</span></span>
<span id="cb7-24"><a href="#cb7-24"></a><span class="co">## [20] 100 128  96  10 101 126 111  51  22  64 105   5  40  78 129</span></span>
<span id="cb7-25"><a href="#cb7-25"></a><span class="co">## </span></span>
<span id="cb7-26"><a href="#cb7-26"></a><span class="co">## </span></span>
<span id="cb7-27"><a href="#cb7-27"></a><span class="co">## </span></span>
<span id="cb7-28"><a href="#cb7-28"></a><span class="co">## [[2]]</span></span>
<span id="cb7-29"><a href="#cb7-29"></a><span class="co">## [[2]]$train.inds</span></span>
<span id="cb7-30"><a href="#cb7-30"></a><span class="co">## [[2]]$train.inds[[1]]</span></span>
<span id="cb7-31"><a href="#cb7-31"></a><span class="co">##  [1] 143  56 119 108  48  49  85  43 120  24 135 146 149 114  12 133  40  36   6</span></span>
<span id="cb7-32"><a href="#cb7-32"></a><span class="co">## [20]  33 107  13 128  31  73 127  46 140  59  41  51  35 100  72   7  53  44  77</span></span>
<span id="cb7-33"><a href="#cb7-33"></a><span class="co">## [39] 150  20 105  74  90 118  52  92  79 137   3  57  16 121  87  45  76  80  30</span></span>
<span id="cb7-34"><a href="#cb7-34"></a><span class="co">## [58]  94  26  95  15  63 126  89  67 124</span></span>
<span id="cb7-35"><a href="#cb7-35"></a><span class="co">## </span></span>
<span id="cb7-36"><a href="#cb7-36"></a><span class="co">## [[2]]$train.inds[[2]]</span></span>
<span id="cb7-37"><a href="#cb7-37"></a><span class="co">##  [1]  59 111   3  48  76  16 140 149   8   5 128  94  20  79  87  42  85  83  35</span></span>
<span id="cb7-38"><a href="#cb7-38"></a><span class="co">## [20] 138  62  56  21  44 121  25 135  18 144 114  45  89 127  36  88  81 101  92</span></span>
<span id="cb7-39"><a href="#cb7-39"></a><span class="co">## [39]  73  39 145  61  24 150  90  51  13   4 108  70  26 104 119 146 129  46  77</span></span>
<span id="cb7-40"><a href="#cb7-40"></a><span class="co">## [58]  17 133  97  23 107 120  63 143 118</span></span>
<span id="cb7-41"><a href="#cb7-41"></a><span class="co">## </span></span>
<span id="cb7-42"><a href="#cb7-42"></a><span class="co">## </span></span>
<span id="cb7-43"><a href="#cb7-43"></a><span class="co">## [[2]]$test.inds</span></span>
<span id="cb7-44"><a href="#cb7-44"></a><span class="co">## [[2]]$test.inds[[1]]</span></span>
<span id="cb7-45"><a href="#cb7-45"></a><span class="co">##  [1]   5  17  19  18  55  61  25  47   4 131 129 101 144  88  81  99  62  70 145</span></span>
<span id="cb7-46"><a href="#cb7-46"></a><span class="co">## [20]  50 111  23  21  39  97  58  42  71 104  66 138  78   8  83</span></span>
<span id="cb7-47"><a href="#cb7-47"></a><span class="co">## </span></span>
<span id="cb7-48"><a href="#cb7-48"></a><span class="co">## [[2]]$test.inds[[2]]</span></span>
<span id="cb7-49"><a href="#cb7-49"></a><span class="co">##  [1] 126 100  19  15  55  40  43  47  74 105   7 131 124  49  12  53  99  33   6</span></span>
<span id="cb7-50"><a href="#cb7-50"></a><span class="co">## [20]  50  41  52  58  67  31  71  66  57  78  95  72  80 137  30</span></span>
<span id="cb7-51"><a href="#cb7-51"></a><span class="co">## </span></span>
<span id="cb7-52"><a href="#cb7-52"></a><span class="co">## </span></span>
<span id="cb7-53"><a href="#cb7-53"></a><span class="co">## </span></span>
<span id="cb7-54"><a href="#cb7-54"></a><span class="co">## [[3]]</span></span>
<span id="cb7-55"><a href="#cb7-55"></a><span class="co">## [[3]]$train.inds</span></span>
<span id="cb7-56"><a href="#cb7-56"></a><span class="co">## [[3]]$train.inds[[1]]</span></span>
<span id="cb7-57"><a href="#cb7-57"></a><span class="co">##  [1]  63  45  10  75  69 113 106  92   1  29  89  47 142  81 122   6  65  25  71</span></span>
<span id="cb7-58"><a href="#cb7-58"></a><span class="co">## [20]  53  60 120  93 136   9 143 110  48  79  86  19   3  57  24  67 123  66 131</span></span>
<span id="cb7-59"><a href="#cb7-59"></a><span class="co">## [39] 127 140  23   2  85  72  76  39  46 119  82 138 130 149   8  35 116 125  14</span></span>
<span id="cb7-60"><a href="#cb7-60"></a><span class="co">## [58]  34 117  15  64   4  98  27 148 103</span></span>
<span id="cb7-61"><a href="#cb7-61"></a><span class="co">## </span></span>
<span id="cb7-62"><a href="#cb7-62"></a><span class="co">## [[3]]$train.inds[[2]]</span></span>
<span id="cb7-63"><a href="#cb7-63"></a><span class="co">##  [1] 125 140 119 147  84  79  96  47  69  93   3  91 131  95  43  35 134 110  45</span></span>
<span id="cb7-64"><a href="#cb7-64"></a><span class="co">## [20]  85  60  27  53 103   6 137  49  67 115  83 116  76  25  64 149  97   8  52</span></span>
<span id="cb7-65"><a href="#cb7-65"></a><span class="co">## [39]  34  89  28   1  66  21  19  29  11  32 112   9 120   4 108 102  10 127 117</span></span>
<span id="cb7-66"><a href="#cb7-66"></a><span class="co">## [58] 138 113  75 141 143  39  59  22 132</span></span>
<span id="cb7-67"><a href="#cb7-67"></a><span class="co">## </span></span>
<span id="cb7-68"><a href="#cb7-68"></a><span class="co">## </span></span>
<span id="cb7-69"><a href="#cb7-69"></a><span class="co">## [[3]]$test.inds</span></span>
<span id="cb7-70"><a href="#cb7-70"></a><span class="co">## [[3]]$test.inds[[1]]</span></span>
<span id="cb7-71"><a href="#cb7-71"></a><span class="co">##  [1]  52  37  88  22 109  95 102  84 132  83 134 141 115 121 108  54  94 112  32</span></span>
<span id="cb7-72"><a href="#cb7-72"></a><span class="co">## [20]  38  43 139 147  49  28  59  21  97  68 107  91 137  96  11</span></span>
<span id="cb7-73"><a href="#cb7-73"></a><span class="co">## </span></span>
<span id="cb7-74"><a href="#cb7-74"></a><span class="co">## [[3]]$test.inds[[2]]</span></span>
<span id="cb7-75"><a href="#cb7-75"></a><span class="co">##  [1] 130 122  14  37  63  92  82  88 109  57  24  71  72 121  81 142  54  46  94</span></span>
<span id="cb7-76"><a href="#cb7-76"></a><span class="co">## [20]  98  48  38  23 139  86   2 148  15  68 107 136 123 106  65</span></span></code></pre></div>
</div>
</div>
<div id="feature-selection" class="section level1">
<h1 class="hasAnchor">
<a href="#feature-selection" class="anchor"></a>Feature selection</h1>
<p>As you might recall from the section about <a href="feature_selection.html" target="_blank">feature selection</a>, <code>mlr</code> supports the filter and the wrapper approach.</p>
<div id="wrapper-methods" class="section level2">
<h2 class="hasAnchor">
<a href="#wrapper-methods" class="anchor"></a>Wrapper methods</h2>
<p>Wrapper methods use the performance of a learning algorithm to assess the usefulness of a feature set. In order to select a feature subset a learner is trained repeatedly on different feature subsets and the subset which leads to the best learner performance is chosen.</p>
<p>For feature selection in the inner resampling loop, you need to choose a search strategy (function <code>makeFeatSelControl*</code> (<code><a href="../../reference/FeatSelControl.html">FeatSelControl()</a></code>)), a performance measure and the inner resampling strategy. Then use function <code><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper()</a></code> to bind everything together.</p>
<p>Below we use sequential forward selection with linear regression on the <code>BostonHousing</code> (<code><a href="https://rdrr.io/pkg/mlbench/man/BostonHousing.html">mlbench::BostonHousing()</a></code> data set (<code><a href="../../reference/bh.task.html">bh.task()</a></code>).</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1"></a><span class="co"># Feature selection in inner resampling loop</span></span>
<span id="cb8-2"><a href="#cb8-2"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb8-3"><a href="#cb8-3"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper</a></span>(<span class="st">"regr.lm"</span>, <span class="dt">resampling =</span> inner,</span>
<span id="cb8-4"><a href="#cb8-4"></a>  <span class="dt">control =</span> <span class="kw"><a href="../../reference/FeatSelControl.html">makeFeatSelControlSequential</a></span>(<span class="dt">method =</span> <span class="st">"sfs"</span>), <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb8-5"><a href="#cb8-5"></a></span>
<span id="cb8-6"><a href="#cb8-6"></a><span class="co"># Outer resampling loop</span></span>
<span id="cb8-7"><a href="#cb8-7"></a>outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</span>
<span id="cb8-8"><a href="#cb8-8"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="dt">learner =</span> lrn, <span class="dt">task =</span> bh.task, <span class="dt">resampling =</span> outer, <span class="dt">extract =</span> getFeatSelResult,</span>
<span id="cb8-9"><a href="#cb8-9"></a>  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb8-10"><a href="#cb8-10"></a></span>
<span id="cb8-11"><a href="#cb8-11"></a>r</span>
<span id="cb8-12"><a href="#cb8-12"></a></span>
<span id="cb8-13"><a href="#cb8-13"></a><span class="co">## Resample Result</span></span>
<span id="cb8-14"><a href="#cb8-14"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb8-15"><a href="#cb8-15"></a><span class="co">## Learner: regr.lm.featsel</span></span>
<span id="cb8-16"><a href="#cb8-16"></a><span class="co">## Aggr perf: mse.test.mean=24.8753005</span></span>
<span id="cb8-17"><a href="#cb8-17"></a><span class="co">## Runtime: 7.01506</span></span>
<span id="cb8-18"><a href="#cb8-18"></a></span>
<span id="cb8-19"><a href="#cb8-19"></a>r<span class="op">$</span>measures.test</span>
<span id="cb8-20"><a href="#cb8-20"></a></span>
<span id="cb8-21"><a href="#cb8-21"></a><span class="co">##   iter      mse</span></span>
<span id="cb8-22"><a href="#cb8-22"></a><span class="co">## 1    1 22.28967</span></span>
<span id="cb8-23"><a href="#cb8-23"></a><span class="co">## 2    2 27.46093</span></span></code></pre></div>
<div id="accessing-the-selected-features" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-the-selected-features" class="anchor"></a>Accessing the selected features</h3>
<p>The result of the feature selection can be extracted by function <code><a href="../../reference/getFeatSelResult.html">getFeatSelResult()</a></code>. It is also possible to keep whole models (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>) by setting <code>models = TRUE</code> when calling <code><a href="../../reference/resample.html">resample()</a></code>.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a>r<span class="op">$</span>extract</span>
<span id="cb9-2"><a href="#cb9-2"></a><span class="co">## [[1]]</span></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## FeatSel result:</span></span>
<span id="cb9-4"><a href="#cb9-4"></a><span class="co">## Features (8): zn, chas, nox, rm, dis, ptratio, b, lstat</span></span>
<span id="cb9-5"><a href="#cb9-5"></a><span class="co">## mse.test.mean=26.8943900</span></span>
<span id="cb9-6"><a href="#cb9-6"></a><span class="co">## </span></span>
<span id="cb9-7"><a href="#cb9-7"></a><span class="co">## [[2]]</span></span>
<span id="cb9-8"><a href="#cb9-8"></a><span class="co">## FeatSel result:</span></span>
<span id="cb9-9"><a href="#cb9-9"></a><span class="co">## Features (10): crim, zn, nox, rm, dis, rad, tax, ptratio, b, l...</span></span>
<span id="cb9-10"><a href="#cb9-10"></a><span class="co">## mse.test.mean=21.5240684</span></span>
<span id="cb9-11"><a href="#cb9-11"></a></span>
<span id="cb9-12"><a href="#cb9-12"></a><span class="co"># Selected features in the first outer resampling iteration</span></span>
<span id="cb9-13"><a href="#cb9-13"></a>r<span class="op">$</span>extract[[<span class="dv">1</span>]]<span class="op">$</span>x</span>
<span id="cb9-14"><a href="#cb9-14"></a><span class="co">## [1] "zn"      "chas"    "nox"     "rm"      "dis"     "ptratio" "b"      </span></span>
<span id="cb9-15"><a href="#cb9-15"></a><span class="co">## [8] "lstat"</span></span>
<span id="cb9-16"><a href="#cb9-16"></a></span>
<span id="cb9-17"><a href="#cb9-17"></a><span class="co"># Resampled performance of the selected feature subset on the first inner training set</span></span>
<span id="cb9-18"><a href="#cb9-18"></a>r<span class="op">$</span>extract[[<span class="dv">1</span>]]<span class="op">$</span>y</span>
<span id="cb9-19"><a href="#cb9-19"></a><span class="co">## mse.test.mean </span></span>
<span id="cb9-20"><a href="#cb9-20"></a><span class="co">##      26.89439</span></span></code></pre></div>
<p>As for tuning, you can extract the optimization paths. The resulting <code>data.frame</code>s contain, among others, binary columns for all features, indicating if they were included in the linear regression model, and the corresponding performances.</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1"></a>opt.paths =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(r<span class="op">$</span>extract, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(x<span class="op">$</span>opt.path))</span>
<span id="cb10-2"><a href="#cb10-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(opt.paths[[<span class="dv">1</span>]])</span>
<span id="cb10-3"><a href="#cb10-3"></a></span>
<span id="cb10-4"><a href="#cb10-4"></a><span class="co">##   crim zn indus chas nox rm age dis rad tax ptratio b lstat mse.test.mean</span></span>
<span id="cb10-5"><a href="#cb10-5"></a><span class="co">## 1    0  0     0    0   0  0   0   0   0   0       0 0     0      84.52018</span></span>
<span id="cb10-6"><a href="#cb10-6"></a><span class="co">## 2    1  0     0    0   0  0   0   0   0   0       0 0     0      95.46348</span></span>
<span id="cb10-7"><a href="#cb10-7"></a><span class="co">## 3    0  1     0    0   0  0   0   0   0   0       0 0     0      74.97858</span></span>
<span id="cb10-8"><a href="#cb10-8"></a><span class="co">## 4    0  0     1    0   0  0   0   0   0   0       0 0     0      66.35546</span></span>
<span id="cb10-9"><a href="#cb10-9"></a><span class="co">## 5    0  0     0    1   0  0   0   0   0   0       0 0     0      81.49228</span></span>
<span id="cb10-10"><a href="#cb10-10"></a><span class="co">## 6    0  0     0    0   1  0   0   0   0   0       0 0     0      67.72664</span></span>
<span id="cb10-11"><a href="#cb10-11"></a><span class="co">##   dob eol error.message exec.time</span></span>
<span id="cb10-12"><a href="#cb10-12"></a><span class="co">## 1   1   2          &lt;NA&gt;     0.031</span></span>
<span id="cb10-13"><a href="#cb10-13"></a><span class="co">## 2   2   2          &lt;NA&gt;     0.037</span></span>
<span id="cb10-14"><a href="#cb10-14"></a><span class="co">## 3   2   2          &lt;NA&gt;     0.027</span></span>
<span id="cb10-15"><a href="#cb10-15"></a><span class="co">## 4   2   2          &lt;NA&gt;     0.030</span></span>
<span id="cb10-16"><a href="#cb10-16"></a><span class="co">## 5   2   2          &lt;NA&gt;     0.032</span></span>
<span id="cb10-17"><a href="#cb10-17"></a><span class="co">## 6   2   2          &lt;NA&gt;     0.031</span></span></code></pre></div>
<p>An easy-to-read version of the optimization path for sequential feature selection can be obtained with function <code><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult()</a></code>.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="kw"><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult</a></span>(r<span class="op">$</span>extract[[<span class="dv">1</span>]])</span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">## Features         : 8</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## Performance      : mse.test.mean=26.8943900</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## zn, chas, nox, rm, dis, ptratio, b, lstat</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">## </span></span>
<span id="cb11-6"><a href="#cb11-6"></a><span class="co">## Path to optimum:</span></span>
<span id="cb11-7"><a href="#cb11-7"></a><span class="co">## - Features:    0  Init   :                       Perf = 91.377  Diff: NA  *</span></span>
<span id="cb11-8"><a href="#cb11-8"></a><span class="co">## - Features:    1  Add    : lstat                 Perf = 40.871  Diff: 50.506  *</span></span>
<span id="cb11-9"><a href="#cb11-9"></a><span class="co">## - Features:    2  Add    : rm                    Perf = 34.606  Diff: 6.265  *</span></span>
<span id="cb11-10"><a href="#cb11-10"></a><span class="co">## - Features:    3  Add    : ptratio               Perf = 31.673  Diff: 2.9328  *</span></span>
<span id="cb11-11"><a href="#cb11-11"></a><span class="co">## - Features:    4  Add    : dis                   Perf = 30.535  Diff: 1.1381  *</span></span>
<span id="cb11-12"><a href="#cb11-12"></a><span class="co">## - Features:    5  Add    : nox                   Perf = 28.968  Diff: 1.5667  *</span></span>
<span id="cb11-13"><a href="#cb11-13"></a><span class="co">## - Features:    6  Add    : zn                    Perf = 27.993  Diff: 0.97562  *</span></span>
<span id="cb11-14"><a href="#cb11-14"></a><span class="co">## - Features:    7  Add    : b                     Perf = 27.253  Diff: 0.73917  *</span></span>
<span id="cb11-15"><a href="#cb11-15"></a><span class="co">## - Features:    8  Add    : chas                  Perf = 26.894  Diff: 0.35905  *</span></span>
<span id="cb11-16"><a href="#cb11-16"></a><span class="co">## </span></span>
<span id="cb11-17"><a href="#cb11-17"></a><span class="co">## Stopped, because no improving feature was found.</span></span></code></pre></div>
</div>
</div>
<div id="filter-methods-with-tuning" class="section level2">
<h2 class="hasAnchor">
<a href="#filter-methods-with-tuning" class="anchor"></a>Filter methods with tuning</h2>
<p>Filter methods assign an importance value to each feature. Based on these values you can select a feature subset by either keeping all features with importance higher than a certain threshold or by keeping a fixed number or percentage of the highest ranking features. Often, neither the theshold nor the number or percentage of features is known in advance and thus tuning is necessary.</p>
<p>In the example below the threshold value (<code>fw.threshold</code>) is tuned in the inner resampling loop. For this purpose the base Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>) <code>"regr.lm"</code> is wrapped two times. First, <code><a href="../../reference/makeFilterWrapper.html">makeFilterWrapper()</a></code> is used to fuse linear regression with a feature filtering preprocessing step. Then a tuning step is added by <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code>.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1"></a><span class="co"># Tuning of the percentage of selected filters in the inner loop</span></span>
<span id="cb12-2"><a href="#cb12-2"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFilterWrapper.html">makeFilterWrapper</a></span>(<span class="dt">learner =</span> <span class="st">"regr.lm"</span>, <span class="dt">fw.method =</span> <span class="st">"FSelector_chi.squared"</span>)</span>
<span id="cb12-3"><a href="#cb12-3"></a>ps =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeDiscreteParam</span>(<span class="st">"fw.threshold"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.2</span>)))</span>
<span id="cb12-4"><a href="#cb12-4"></a>ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</span>
<span id="cb12-5"><a href="#cb12-5"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb12-6"><a href="#cb12-6"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(lrn, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-7"><a href="#cb12-7"></a></span>
<span id="cb12-8"><a href="#cb12-8"></a><span class="co"># Outer resampling loop</span></span>
<span id="cb12-9"><a href="#cb12-9"></a>outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb12-10"><a href="#cb12-10"></a>r =<span class="st"> </span><span class="kw"><a href="../../reference/resample.html">resample</a></span>(<span class="dt">learner =</span> lrn, <span class="dt">task =</span> bh.task, <span class="dt">resampling =</span> outer, <span class="dt">models =</span> <span class="ot">TRUE</span>, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb12-11"><a href="#cb12-11"></a>r</span>
<span id="cb12-12"><a href="#cb12-12"></a></span>
<span id="cb12-13"><a href="#cb12-13"></a><span class="co">## Resample Result</span></span>
<span id="cb12-14"><a href="#cb12-14"></a><span class="co">## Task: BostonHousing-example</span></span>
<span id="cb12-15"><a href="#cb12-15"></a><span class="co">## Learner: regr.lm.filtered.tuned</span></span>
<span id="cb12-16"><a href="#cb12-16"></a><span class="co">## Aggr perf: mse.test.mean=23.5449481</span></span>
<span id="cb12-17"><a href="#cb12-17"></a><span class="co">## Runtime: 3.85235</span></span></code></pre></div>
<div id="accessing-the-selected-features-and-optimal-percentage" class="section level3">
<h3 class="hasAnchor">
<a href="#accessing-the-selected-features-and-optimal-percentage" class="anchor"></a>Accessing the selected features and optimal percentage</h3>
<p>In the above example we kept the complete model (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s.</p>
<p>Below are some examples that show how to extract information from the model (<code><a href="../../reference/makeWrappedModel.html">makeWrappedModel()</a></code>)s.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1"></a>r<span class="op">$</span>models</span>
<span id="cb13-2"><a href="#cb13-2"></a><span class="co">## [[1]]</span></span>
<span id="cb13-3"><a href="#cb13-3"></a><span class="co">## Model for learner.id=regr.lm.filtered.tuned; learner.class=TuneWrapper</span></span>
<span id="cb13-4"><a href="#cb13-4"></a><span class="co">## Trained on: task.id = BostonHousing-example; obs = 337; features = 13</span></span>
<span id="cb13-5"><a href="#cb13-5"></a><span class="co">## Hyperparameters: fw.method=FSelector_ch...</span></span>
<span id="cb13-6"><a href="#cb13-6"></a><span class="co">## </span></span>
<span id="cb13-7"><a href="#cb13-7"></a><span class="co">## [[2]]</span></span>
<span id="cb13-8"><a href="#cb13-8"></a><span class="co">## Model for learner.id=regr.lm.filtered.tuned; learner.class=TuneWrapper</span></span>
<span id="cb13-9"><a href="#cb13-9"></a><span class="co">## Trained on: task.id = BostonHousing-example; obs = 337; features = 13</span></span>
<span id="cb13-10"><a href="#cb13-10"></a><span class="co">## Hyperparameters: fw.method=FSelector_ch...</span></span>
<span id="cb13-11"><a href="#cb13-11"></a><span class="co">## </span></span>
<span id="cb13-12"><a href="#cb13-12"></a><span class="co">## [[3]]</span></span>
<span id="cb13-13"><a href="#cb13-13"></a><span class="co">## Model for learner.id=regr.lm.filtered.tuned; learner.class=TuneWrapper</span></span>
<span id="cb13-14"><a href="#cb13-14"></a><span class="co">## Trained on: task.id = BostonHousing-example; obs = 338; features = 13</span></span>
<span id="cb13-15"><a href="#cb13-15"></a><span class="co">## Hyperparameters: fw.method=FSelector_ch...</span></span></code></pre></div>
<p>The result of the feature selection can be extracted by function <code><a href="../../reference/getFilteredFeatures.html">getFilteredFeatures()</a></code>. Almost always all 13 features are selected.</p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(r<span class="op">$</span>models, <span class="cf">function</span>(x) <span class="kw"><a href="../../reference/getFilteredFeatures.html">getFilteredFeatures</a></span>(x<span class="op">$</span>learner.model<span class="op">$</span>next.model))</span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">## [[1]]</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">##  [1] "crim"    "zn"      "indus"   "chas"    "nox"     "rm"      "age"    </span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">##  [8] "dis"     "rad"     "tax"     "ptratio" "b"       "lstat"  </span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">## </span></span>
<span id="cb14-6"><a href="#cb14-6"></a><span class="co">## [[2]]</span></span>
<span id="cb14-7"><a href="#cb14-7"></a><span class="co">##  [1] "crim"    "zn"      "indus"   "chas"    "nox"     "rm"      "age"    </span></span>
<span id="cb14-8"><a href="#cb14-8"></a><span class="co">##  [8] "dis"     "rad"     "tax"     "ptratio" "b"       "lstat"  </span></span>
<span id="cb14-9"><a href="#cb14-9"></a><span class="co">## </span></span>
<span id="cb14-10"><a href="#cb14-10"></a><span class="co">## [[3]]</span></span>
<span id="cb14-11"><a href="#cb14-11"></a><span class="co">##  [1] "crim"    "zn"      "indus"   "nox"     "rm"      "age"     "dis"    </span></span>
<span id="cb14-12"><a href="#cb14-12"></a><span class="co">##  [8] "rad"     "tax"     "ptratio" "b"       "lstat"</span></span></code></pre></div>
<p>Below the tune results (<code><a href="../../reference/TuneResult.html">TuneResult()</a></code>) and optimization paths (<code><a href="https://paramhelpers.mlr-org.com/reference/OptPath.html">ParamHelpers::OptPath()</a></code>) are accessed.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb15-1"><a href="#cb15-1"></a>res =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(r<span class="op">$</span>models, getTuneResult)</span>
<span id="cb15-2"><a href="#cb15-2"></a>res</span>
<span id="cb15-3"><a href="#cb15-3"></a><span class="co">## [[1]]</span></span>
<span id="cb15-4"><a href="#cb15-4"></a><span class="co">## Tune result:</span></span>
<span id="cb15-5"><a href="#cb15-5"></a><span class="co">## Op. pars: fw.threshold=0</span></span>
<span id="cb15-6"><a href="#cb15-6"></a><span class="co">## mse.test.mean=24.0256189</span></span>
<span id="cb15-7"><a href="#cb15-7"></a><span class="co">## </span></span>
<span id="cb15-8"><a href="#cb15-8"></a><span class="co">## [[2]]</span></span>
<span id="cb15-9"><a href="#cb15-9"></a><span class="co">## Tune result:</span></span>
<span id="cb15-10"><a href="#cb15-10"></a><span class="co">## Op. pars: fw.threshold=0</span></span>
<span id="cb15-11"><a href="#cb15-11"></a><span class="co">## mse.test.mean=22.3639004</span></span>
<span id="cb15-12"><a href="#cb15-12"></a><span class="co">## </span></span>
<span id="cb15-13"><a href="#cb15-13"></a><span class="co">## [[3]]</span></span>
<span id="cb15-14"><a href="#cb15-14"></a><span class="co">## Tune result:</span></span>
<span id="cb15-15"><a href="#cb15-15"></a><span class="co">## Op. pars: fw.threshold=0.4</span></span>
<span id="cb15-16"><a href="#cb15-16"></a><span class="co">## mse.test.mean=25.2760972</span></span>
<span id="cb15-17"><a href="#cb15-17"></a></span>
<span id="cb15-18"><a href="#cb15-18"></a>opt.paths =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(res, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(x<span class="op">$</span>opt.path))</span>
<span id="cb15-19"><a href="#cb15-19"></a>opt.paths[[<span class="dv">1</span>]][, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(opt.paths[[<span class="dv">1</span>]])]</span>
<span id="cb15-20"><a href="#cb15-20"></a><span class="co">##   fw.threshold mse.test.mean dob eol error.message</span></span>
<span id="cb15-21"><a href="#cb15-21"></a><span class="co">## 1            0      24.02562   1  NA          &lt;NA&gt;</span></span>
<span id="cb15-22"><a href="#cb15-22"></a><span class="co">## 2          0.2      24.40786   2  NA          &lt;NA&gt;</span></span>
<span id="cb15-23"><a href="#cb15-23"></a><span class="co">## 3          0.4      24.40786   3  NA          &lt;NA&gt;</span></span>
<span id="cb15-24"><a href="#cb15-24"></a><span class="co">## 4          0.6      41.66803   4  NA          &lt;NA&gt;</span></span>
<span id="cb15-25"><a href="#cb15-25"></a><span class="co">## 5          0.8      77.80529   5  NA          &lt;NA&gt;</span></span>
<span id="cb15-26"><a href="#cb15-26"></a><span class="co">## 6            1      77.80529   6  NA          &lt;NA&gt;</span></span></code></pre></div>
</div>
</div>
</div>
<div id="benchmark-experiments" class="section level1">
<h1 class="hasAnchor">
<a href="#benchmark-experiments" class="anchor"></a>Benchmark experiments</h1>
<p>In a benchmark experiment multiple learners are compared on one or several tasks (see also the section about <a href="benchmark_experiments.html" target="_blank">benchmarking</a>. Nested resampling in benchmark experiments is achieved the same way as in resampling:</p>
<ul>
<li>First, use <code><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper()</a></code> or <code><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper()</a></code> to generate wrapped Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>)s with the inner resampling strategies of your choice.</li>
<li>Second, call <code><a href="../../reference/benchmark.html">benchmark()</a></code> and specify the outer resampling strategies for all tasks.</li>
</ul>
<p>The inner resampling strategies should be resample descriptions (<code><a href="../../reference/makeResampleDesc.html">makeResampleDesc()</a></code>). You can use different inner resampling strategies for different wrapped learners. For example it might be practical to do fewer subsampling or bootstrap iterations for slower learners.</p>
<p>If you have larger benchmark experiments you might want to have a look at the section about <a href="parallelization.html" target="_blank">parallelization</a>.</p>
<p>As mentioned in the section about <a href="benchmark_experiments.html" target="_blank">benchmark experiments</a> you can also use different resampling strategies for different learning tasks by passing a <code>list</code> of resampling descriptions or instances to <code><a href="../../reference/benchmark.html">benchmark()</a></code>.</p>
<p>We will see three examples to show different benchmark settings:</p>
<ol style="list-style-type: decimal">
<li>Two data sets + two classification algorithms + tuning</li>
<li>One data set + two regression algorithms + feature selection</li>
<li>One data set + two regression algorithms + feature filtering + tuning</li>
</ol>
<div id="example-1-two-tasks-two-learners-tuning" class="section level2">
<h2 class="hasAnchor">
<a href="#example-1-two-tasks-two-learners-tuning" class="anchor"></a>Example 1: Two tasks, two learners, tuning</h2>
<p>Below is a benchmark experiment with two data sets, <code><a href="https://rdrr.io/r/datasets/iris.html">datasets::iris()</a></code> and <code>mlbench::sonar()</code>, and two Learner (<code><a href="../../reference/makeLearner.html">makeLearner()</a></code>)s, <code><a href="https://rdrr.io/pkg/kernlab/man/ksvm.html">kernlab::ksvm()</a></code> and <code><a href="https://rdrr.io/pkg/kknn/man/kknn.html">kknn::kknn()</a></code>, that are both tuned.</p>
<p>As inner resampling strategies we use holdout for <code><a href="https://rdrr.io/pkg/kernlab/man/ksvm.html">kernlab::ksvm()</a></code> and subsampling with 3 iterations for <code><a href="https://rdrr.io/pkg/kknn/man/kknn.html">kknn::kknn()</a></code>. As outer resampling strategies we take holdout for the <code><a href="https://rdrr.io/r/datasets/iris.html">datasets::iris()</a></code> and bootstrap with 2 iterations for the <code>mlbench::sonar()</code> data (<code><a href="../../reference/sonar.task.html">sonar.task()</a></code>). We consider the accuracy (<a href="measures.html" target="_blank">acc</a>), which is used as tuning criterion, and also calculate the balanced error rate (<a href="measures.html" target="_blank">ber</a>).</p>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co"># List of learning tasks</span></span>
<span id="cb16-2"><a href="#cb16-2"></a>tasks =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(iris.task, sonar.task)</span>
<span id="cb16-3"><a href="#cb16-3"></a></span>
<span id="cb16-4"><a href="#cb16-4"></a><span class="co"># Tune svm in the inner resampling loop</span></span>
<span id="cb16-5"><a href="#cb16-5"></a>ps =<span class="st"> </span><span class="kw">makeParamSet</span>(</span>
<span id="cb16-6"><a href="#cb16-6"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"C"</span>, <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>)),</span>
<span id="cb16-7"><a href="#cb16-7"></a>  <span class="kw">makeDiscreteParam</span>(<span class="st">"sigma"</span>, <span class="dv">2</span><span class="op">^</span>(<span class="op">-</span><span class="dv">1</span><span class="op">:</span><span class="dv">1</span>)))</span>
<span id="cb16-8"><a href="#cb16-8"></a>ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</span>
<span id="cb16-9"><a href="#cb16-9"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>)</span>
<span id="cb16-10"><a href="#cb16-10"></a>lrn1 =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(<span class="st">"classif.ksvm"</span>, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl,</span>
<span id="cb16-11"><a href="#cb16-11"></a>  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb16-12"><a href="#cb16-12"></a></span>
<span id="cb16-13"><a href="#cb16-13"></a><span class="co"># Tune k-nearest neighbor in inner resampling loop</span></span>
<span id="cb16-14"><a href="#cb16-14"></a>ps =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeDiscreteParam</span>(<span class="st">"k"</span>, <span class="dv">3</span><span class="op">:</span><span class="dv">5</span>))</span>
<span id="cb16-15"><a href="#cb16-15"></a>ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</span>
<span id="cb16-16"><a href="#cb16-16"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">3</span>)</span>
<span id="cb16-17"><a href="#cb16-17"></a>lrn2 =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(<span class="st">"classif.kknn"</span>, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl,</span>
<span id="cb16-18"><a href="#cb16-18"></a>  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb16-19"><a href="#cb16-19"></a><span class="co">## Loading required package: kknn</span></span>
<span id="cb16-20"><a href="#cb16-20"></a></span>
<span id="cb16-21"><a href="#cb16-21"></a><span class="co"># Learners</span></span>
<span id="cb16-22"><a href="#cb16-22"></a>lrns =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(lrn1, lrn2)</span>
<span id="cb16-23"><a href="#cb16-23"></a></span>
<span id="cb16-24"><a href="#cb16-24"></a><span class="co"># Outer resampling loop</span></span>
<span id="cb16-25"><a href="#cb16-25"></a>outer =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Holdout"</span>), <span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Bootstrap"</span>, <span class="dt">iters =</span> <span class="dv">2</span>))</span>
<span id="cb16-26"><a href="#cb16-26"></a>res =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(lrns, tasks, outer, <span class="dt">measures =</span> <span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(acc, ber), <span class="dt">show.info =</span> <span class="ot">FALSE</span>, </span>
<span id="cb16-27"><a href="#cb16-27"></a>  <span class="dt">keep.extract =</span> <span class="ot">TRUE</span>)</span>
<span id="cb16-28"><a href="#cb16-28"></a>res</span>
<span id="cb16-29"><a href="#cb16-29"></a><span class="co">##         task.id         learner.id acc.test.mean ber.test.mean</span></span>
<span id="cb16-30"><a href="#cb16-30"></a><span class="co">## 1  iris-example classif.ksvm.tuned     0.9800000    0.02222222</span></span>
<span id="cb16-31"><a href="#cb16-31"></a><span class="co">## 2  iris-example classif.kknn.tuned     0.9600000    0.04305556</span></span>
<span id="cb16-32"><a href="#cb16-32"></a><span class="co">## 3 Sonar-example classif.ksvm.tuned     0.4903819    0.50000000</span></span>
<span id="cb16-33"><a href="#cb16-33"></a><span class="co">## 4 Sonar-example classif.kknn.tuned     0.8725237    0.12827855</span></span></code></pre></div>
<p>The <code>print</code> method for the <code><a href="../../reference/BenchmarkResult.html">BenchmarkResult()</a></code> shows the aggregated performances from the outer resampling loop.</p>
<p>As you might recall, <code>mlr</code> offers several accessor function to extract information from the benchmark result. These are listed on the help page of <code><a href="../../reference/BenchmarkResult.html">BenchmarkResult()</a></code> and many examples are shown on the tutorial page about <a href="benchmark_experiments.html" target="_blank">benchmark experiments</a>.</p>
<p>The performance values in individual outer resampling runs can be obtained by <code><a href="../../reference/getBMRPerformances.html">getBMRPerformances()</a></code>. Note that, since we used different outer resampling strategies for the two tasks, the number of rows per task differ.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb17-1"><a href="#cb17-1"></a><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(res, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</span>
<span id="cb17-2"><a href="#cb17-2"></a><span class="co">##         task.id         learner.id iter       acc        ber</span></span>
<span id="cb17-3"><a href="#cb17-3"></a><span class="co">## 1  iris-example classif.ksvm.tuned    1 0.9800000 0.02222222</span></span>
<span id="cb17-4"><a href="#cb17-4"></a><span class="co">## 2  iris-example classif.kknn.tuned    1 0.9600000 0.04305556</span></span>
<span id="cb17-5"><a href="#cb17-5"></a><span class="co">## 3 Sonar-example classif.ksvm.tuned    1 0.5116279 0.50000000</span></span>
<span id="cb17-6"><a href="#cb17-6"></a><span class="co">## 4 Sonar-example classif.ksvm.tuned    2 0.4691358 0.50000000</span></span>
<span id="cb17-7"><a href="#cb17-7"></a><span class="co">## 5 Sonar-example classif.kknn.tuned    1 0.9302326 0.07142857</span></span>
<span id="cb17-8"><a href="#cb17-8"></a><span class="co">## 6 Sonar-example classif.kknn.tuned    2 0.8148148 0.18512852</span></span></code></pre></div>
<p>The results from the parameter tuning can be obtained through function <code><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults()</a></code>.</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="kw"><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults</a></span>(res)</span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">## $`iris-example`</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">## $`iris-example`$classif.ksvm.tuned</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">## $`iris-example`$classif.ksvm.tuned[[1]]</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">## Tune result:</span></span>
<span id="cb18-6"><a href="#cb18-6"></a><span class="co">## Op. pars: C=2; sigma=0.5</span></span>
<span id="cb18-7"><a href="#cb18-7"></a><span class="co">## mmce.test.mean=0.0294118</span></span>
<span id="cb18-8"><a href="#cb18-8"></a><span class="co">## </span></span>
<span id="cb18-9"><a href="#cb18-9"></a><span class="co">## </span></span>
<span id="cb18-10"><a href="#cb18-10"></a><span class="co">## $`iris-example`$classif.kknn.tuned</span></span>
<span id="cb18-11"><a href="#cb18-11"></a><span class="co">## $`iris-example`$classif.kknn.tuned[[1]]</span></span>
<span id="cb18-12"><a href="#cb18-12"></a><span class="co">## Tune result:</span></span>
<span id="cb18-13"><a href="#cb18-13"></a><span class="co">## Op. pars: k=5</span></span>
<span id="cb18-14"><a href="#cb18-14"></a><span class="co">## mmce.test.mean=0.0392157</span></span>
<span id="cb18-15"><a href="#cb18-15"></a><span class="co">## </span></span>
<span id="cb18-16"><a href="#cb18-16"></a><span class="co">## </span></span>
<span id="cb18-17"><a href="#cb18-17"></a><span class="co">## </span></span>
<span id="cb18-18"><a href="#cb18-18"></a><span class="co">## $`Sonar-example`</span></span>
<span id="cb18-19"><a href="#cb18-19"></a><span class="co">## $`Sonar-example`$classif.ksvm.tuned</span></span>
<span id="cb18-20"><a href="#cb18-20"></a><span class="co">## $`Sonar-example`$classif.ksvm.tuned[[1]]</span></span>
<span id="cb18-21"><a href="#cb18-21"></a><span class="co">## Tune result:</span></span>
<span id="cb18-22"><a href="#cb18-22"></a><span class="co">## Op. pars: C=1; sigma=2</span></span>
<span id="cb18-23"><a href="#cb18-23"></a><span class="co">## mmce.test.mean=0.2285714</span></span>
<span id="cb18-24"><a href="#cb18-24"></a><span class="co">## </span></span>
<span id="cb18-25"><a href="#cb18-25"></a><span class="co">## $`Sonar-example`$classif.ksvm.tuned[[2]]</span></span>
<span id="cb18-26"><a href="#cb18-26"></a><span class="co">## Tune result:</span></span>
<span id="cb18-27"><a href="#cb18-27"></a><span class="co">## Op. pars: C=0.5; sigma=0.5</span></span>
<span id="cb18-28"><a href="#cb18-28"></a><span class="co">## mmce.test.mean=0.2714286</span></span>
<span id="cb18-29"><a href="#cb18-29"></a><span class="co">## </span></span>
<span id="cb18-30"><a href="#cb18-30"></a><span class="co">## </span></span>
<span id="cb18-31"><a href="#cb18-31"></a><span class="co">## $`Sonar-example`$classif.kknn.tuned</span></span>
<span id="cb18-32"><a href="#cb18-32"></a><span class="co">## $`Sonar-example`$classif.kknn.tuned[[1]]</span></span>
<span id="cb18-33"><a href="#cb18-33"></a><span class="co">## Tune result:</span></span>
<span id="cb18-34"><a href="#cb18-34"></a><span class="co">## Op. pars: k=5</span></span>
<span id="cb18-35"><a href="#cb18-35"></a><span class="co">## mmce.test.mean=0.0714286</span></span>
<span id="cb18-36"><a href="#cb18-36"></a><span class="co">## </span></span>
<span id="cb18-37"><a href="#cb18-37"></a><span class="co">## $`Sonar-example`$classif.kknn.tuned[[2]]</span></span>
<span id="cb18-38"><a href="#cb18-38"></a><span class="co">## Tune result:</span></span>
<span id="cb18-39"><a href="#cb18-39"></a><span class="co">## Op. pars: k=4</span></span>
<span id="cb18-40"><a href="#cb18-40"></a><span class="co">## mmce.test.mean=0.0666667</span></span></code></pre></div>
<p>As for several other accessor functions a clearer representation as <code>data.frame</code> can be achieved by setting <code>as.df = TRUE</code>.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb19-1"><a href="#cb19-1"></a><span class="kw"><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults</a></span>(res, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</span>
<span id="cb19-2"><a href="#cb19-2"></a><span class="co">##         task.id         learner.id iter   C sigma mmce.test.mean  k</span></span>
<span id="cb19-3"><a href="#cb19-3"></a><span class="co">## 1  iris-example classif.ksvm.tuned    1 2.0   0.5     0.02941176 NA</span></span>
<span id="cb19-4"><a href="#cb19-4"></a><span class="co">## 2  iris-example classif.kknn.tuned    1  NA    NA     0.03921569  5</span></span>
<span id="cb19-5"><a href="#cb19-5"></a><span class="co">## 3 Sonar-example classif.ksvm.tuned    1 1.0   2.0     0.22857143 NA</span></span>
<span id="cb19-6"><a href="#cb19-6"></a><span class="co">## 4 Sonar-example classif.ksvm.tuned    2 0.5   0.5     0.27142857 NA</span></span>
<span id="cb19-7"><a href="#cb19-7"></a><span class="co">## 5 Sonar-example classif.kknn.tuned    1  NA    NA     0.07142857  5</span></span>
<span id="cb19-8"><a href="#cb19-8"></a><span class="co">## 6 Sonar-example classif.kknn.tuned    2  NA    NA     0.06666667  4</span></span></code></pre></div>
<p>It is also possible to extract the tuning results for individual tasks and learners and, as shown in earlier examples, inspect the optimization path (<code><a href="https://paramhelpers.mlr-org.com/reference/OptPath.html">ParamHelpers::OptPath()</a></code>).</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a>tune.res =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRTuneResults.html">getBMRTuneResults</a></span>(res, <span class="dt">task.ids =</span> <span class="st">"Sonar-example"</span>, <span class="dt">learner.ids =</span> <span class="st">"classif.ksvm.tuned"</span>,</span>
<span id="cb20-2"><a href="#cb20-2"></a>  <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</span>
<span id="cb20-3"><a href="#cb20-3"></a>tune.res</span>
<span id="cb20-4"><a href="#cb20-4"></a><span class="co">##         task.id         learner.id iter   C sigma mmce.test.mean</span></span>
<span id="cb20-5"><a href="#cb20-5"></a><span class="co">## 1 Sonar-example classif.ksvm.tuned    1 1.0   2.0      0.2285714</span></span>
<span id="cb20-6"><a href="#cb20-6"></a><span class="co">## 2 Sonar-example classif.ksvm.tuned    2 0.5   0.5      0.2714286</span></span>
<span id="cb20-7"><a href="#cb20-7"></a></span>
<span id="cb20-8"><a href="#cb20-8"></a><span class="kw"><a href="../../reference/getNestedTuneResultsOptPathDf.html">getNestedTuneResultsOptPathDf</a></span>(res<span class="op">$</span>results[[<span class="st">"Sonar-example"</span>]][[<span class="st">"classif.ksvm.tuned"</span>]])</span></code></pre></div>
</div>
<div id="example-2-one-task-two-learners-feature-selection" class="section level2">
<h2 class="hasAnchor">
<a href="#example-2-one-task-two-learners-feature-selection" class="anchor"></a>Example 2: One task, two learners, feature selection</h2>
<p>Letâ€™s see how we can do <a href="feature_selection.html" target="_blank">feature selection</a> in a benchmark experiment:</p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb21-1"><a href="#cb21-1"></a><span class="co"># Feature selection in inner resampling loop</span></span>
<span id="cb21-2"><a href="#cb21-2"></a>ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/FeatSelControl.html">makeFeatSelControlSequential</a></span>(<span class="dt">method =</span> <span class="st">"sfs"</span>)</span>
<span id="cb21-3"><a href="#cb21-3"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</span>
<span id="cb21-4"><a href="#cb21-4"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFeatSelWrapper.html">makeFeatSelWrapper</a></span>(<span class="st">"regr.lm"</span>, <span class="dt">resampling =</span> inner, <span class="dt">control =</span> ctrl, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb21-5"><a href="#cb21-5"></a></span>
<span id="cb21-6"><a href="#cb21-6"></a><span class="co"># Learners</span></span>
<span id="cb21-7"><a href="#cb21-7"></a>lrns =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"regr.rpart"</span>, lrn)</span>
<span id="cb21-8"><a href="#cb21-8"></a></span>
<span id="cb21-9"><a href="#cb21-9"></a><span class="co"># Outer resampling loop</span></span>
<span id="cb21-10"><a href="#cb21-10"></a>outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iters =</span> <span class="dv">2</span>)</span>
<span id="cb21-11"><a href="#cb21-11"></a>res =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(<span class="dt">tasks =</span> bh.task, <span class="dt">learners =</span> lrns, <span class="dt">resampling =</span> outer, </span>
<span id="cb21-12"><a href="#cb21-12"></a>  <span class="dt">show.info =</span> <span class="ot">FALSE</span>, <span class="dt">keep.extract =</span> <span class="ot">TRUE</span>)</span>
<span id="cb21-13"><a href="#cb21-13"></a></span>
<span id="cb21-14"><a href="#cb21-14"></a>res</span>
<span id="cb21-15"><a href="#cb21-15"></a><span class="co">##                 task.id      learner.id mse.test.mean</span></span>
<span id="cb21-16"><a href="#cb21-16"></a><span class="co">## 1 BostonHousing-example      regr.rpart      23.58119</span></span>
<span id="cb21-17"><a href="#cb21-17"></a><span class="co">## 2 BostonHousing-example regr.lm.featsel      24.75507</span></span></code></pre></div>
<p>The selected features can be extracted by function <code><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults()</a></code>. By default, a nested <code>list</code>, with the first level indicating the task and the second level indicating the learner, is returned. If only a single learner or, as in our case, a single task is considered, setting <code>drop = TRUE</code> simplifies the result to a flat <code>list</code>.</p>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="kw"><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults</a></span>(res)</span>
<span id="cb22-2"><a href="#cb22-2"></a><span class="co">## $`BostonHousing-example`</span></span>
<span id="cb22-3"><a href="#cb22-3"></a><span class="co">## $`BostonHousing-example`$regr.rpart</span></span>
<span id="cb22-4"><a href="#cb22-4"></a><span class="co">## NULL</span></span>
<span id="cb22-5"><a href="#cb22-5"></a><span class="co">## </span></span>
<span id="cb22-6"><a href="#cb22-6"></a><span class="co">## $`BostonHousing-example`$regr.lm.featsel</span></span>
<span id="cb22-7"><a href="#cb22-7"></a><span class="co">## $`BostonHousing-example`$regr.lm.featsel[[1]]</span></span>
<span id="cb22-8"><a href="#cb22-8"></a><span class="co">## FeatSel result:</span></span>
<span id="cb22-9"><a href="#cb22-9"></a><span class="co">## Features (7): indus, rm, age, dis, ptratio, b, lstat</span></span>
<span id="cb22-10"><a href="#cb22-10"></a><span class="co">## mse.test.mean=29.4228023</span></span>
<span id="cb22-11"><a href="#cb22-11"></a><span class="co">## </span></span>
<span id="cb22-12"><a href="#cb22-12"></a><span class="co">## $`BostonHousing-example`$regr.lm.featsel[[2]]</span></span>
<span id="cb22-13"><a href="#cb22-13"></a><span class="co">## FeatSel result:</span></span>
<span id="cb22-14"><a href="#cb22-14"></a><span class="co">## Features (9): zn, indus, chas, nox, rm, dis, ptratio, b, lstat</span></span>
<span id="cb22-15"><a href="#cb22-15"></a><span class="co">## mse.test.mean=26.1964766</span></span>
<span id="cb22-16"><a href="#cb22-16"></a><span class="kw"><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults</a></span>(res, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</span>
<span id="cb22-17"><a href="#cb22-17"></a><span class="co">## $regr.rpart</span></span>
<span id="cb22-18"><a href="#cb22-18"></a><span class="co">## NULL</span></span>
<span id="cb22-19"><a href="#cb22-19"></a><span class="co">## </span></span>
<span id="cb22-20"><a href="#cb22-20"></a><span class="co">## $regr.lm.featsel</span></span>
<span id="cb22-21"><a href="#cb22-21"></a><span class="co">## $regr.lm.featsel[[1]]</span></span>
<span id="cb22-22"><a href="#cb22-22"></a><span class="co">## FeatSel result:</span></span>
<span id="cb22-23"><a href="#cb22-23"></a><span class="co">## Features (7): indus, rm, age, dis, ptratio, b, lstat</span></span>
<span id="cb22-24"><a href="#cb22-24"></a><span class="co">## mse.test.mean=29.4228023</span></span>
<span id="cb22-25"><a href="#cb22-25"></a><span class="co">## </span></span>
<span id="cb22-26"><a href="#cb22-26"></a><span class="co">## $regr.lm.featsel[[2]]</span></span>
<span id="cb22-27"><a href="#cb22-27"></a><span class="co">## FeatSel result:</span></span>
<span id="cb22-28"><a href="#cb22-28"></a><span class="co">## Features (9): zn, indus, chas, nox, rm, dis, ptratio, b, lstat</span></span>
<span id="cb22-29"><a href="#cb22-29"></a><span class="co">## mse.test.mean=26.1964766</span></span></code></pre></div>
<p>You can access results for individual learners and tasks and inspect them further.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb23-1"><a href="#cb23-1"></a>feats =<span class="st"> </span><span class="kw"><a href="../../reference/getBMRFeatSelResults.html">getBMRFeatSelResults</a></span>(res, <span class="dt">learner.id =</span> <span class="st">"regr.lm.featsel"</span>, <span class="dt">drop =</span> <span class="ot">TRUE</span>)</span>
<span id="cb23-2"><a href="#cb23-2"></a></span>
<span id="cb23-3"><a href="#cb23-3"></a><span class="co"># Selected features in the first outer resampling iteration</span></span>
<span id="cb23-4"><a href="#cb23-4"></a>feats[[<span class="dv">1</span>]]<span class="op">$</span>x</span>
<span id="cb23-5"><a href="#cb23-5"></a><span class="co">## [1] "indus"   "rm"      "age"     "dis"     "ptratio" "b"       "lstat"</span></span>
<span id="cb23-6"><a href="#cb23-6"></a></span>
<span id="cb23-7"><a href="#cb23-7"></a><span class="co"># Resampled performance of the selected feature subset on the first inner training set</span></span>
<span id="cb23-8"><a href="#cb23-8"></a>feats[[<span class="dv">1</span>]]<span class="op">$</span>y</span>
<span id="cb23-9"><a href="#cb23-9"></a><span class="co">## mse.test.mean </span></span>
<span id="cb23-10"><a href="#cb23-10"></a><span class="co">##       29.4228</span></span></code></pre></div>
<p>As for tuning, you can extract the optimization paths. The resulting <code>data.frame</code>s contain, among others, binary columns for all features, indicating if they were included in the linear regression model, and the corresponding performances. <code><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult()</a></code> gives a clearer overview.</p>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a>opt.paths =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span>(feats, <span class="cf">function</span>(x) <span class="kw"><a href="https://rdrr.io/r/base/as.data.frame.html">as.data.frame</a></span>(x<span class="op">$</span>opt.path))</span>
<span id="cb24-2"><a href="#cb24-2"></a><span class="kw"><a href="https://rdrr.io/r/utils/head.html">head</a></span>(opt.paths[[<span class="dv">1</span>]][, <span class="op">-</span><span class="kw"><a href="https://rdrr.io/r/base/nrow.html">ncol</a></span>(opt.paths[[<span class="dv">1</span>]])])</span>
<span id="cb24-3"><a href="#cb24-3"></a><span class="co">##   crim zn indus chas nox rm age dis rad tax ptratio b lstat mse.test.mean dob</span></span>
<span id="cb24-4"><a href="#cb24-4"></a><span class="co">## 1    0  0     0    0   0  0   0   0   0   0       0 0     0      80.74823   1</span></span>
<span id="cb24-5"><a href="#cb24-5"></a><span class="co">## 2    1  0     0    0   0  0   0   0   0   0       0 0     0      70.11222   2</span></span>
<span id="cb24-6"><a href="#cb24-6"></a><span class="co">## 3    0  1     0    0   0  0   0   0   0   0       0 0     0      71.63520   2</span></span>
<span id="cb24-7"><a href="#cb24-7"></a><span class="co">## 4    0  0     1    0   0  0   0   0   0   0       0 0     0      64.69041   2</span></span>
<span id="cb24-8"><a href="#cb24-8"></a><span class="co">## 5    0  0     0    1   0  0   0   0   0   0       0 0     0      83.04175   2</span></span>
<span id="cb24-9"><a href="#cb24-9"></a><span class="co">## 6    0  0     0    0   1  0   0   0   0   0       0 0     0      68.37808   2</span></span>
<span id="cb24-10"><a href="#cb24-10"></a><span class="co">##   eol error.message</span></span>
<span id="cb24-11"><a href="#cb24-11"></a><span class="co">## 1   2          &lt;NA&gt;</span></span>
<span id="cb24-12"><a href="#cb24-12"></a><span class="co">## 2   2          &lt;NA&gt;</span></span>
<span id="cb24-13"><a href="#cb24-13"></a><span class="co">## 3   2          &lt;NA&gt;</span></span>
<span id="cb24-14"><a href="#cb24-14"></a><span class="co">## 4   2          &lt;NA&gt;</span></span>
<span id="cb24-15"><a href="#cb24-15"></a><span class="co">## 5   2          &lt;NA&gt;</span></span>
<span id="cb24-16"><a href="#cb24-16"></a><span class="co">## 6   2          &lt;NA&gt;</span></span>
<span id="cb24-17"><a href="#cb24-17"></a></span>
<span id="cb24-18"><a href="#cb24-18"></a><span class="kw"><a href="../../reference/analyzeFeatSelResult.html">analyzeFeatSelResult</a></span>(feats[[<span class="dv">1</span>]])</span>
<span id="cb24-19"><a href="#cb24-19"></a><span class="co">## Features         : 7</span></span>
<span id="cb24-20"><a href="#cb24-20"></a><span class="co">## Performance      : mse.test.mean=29.4228023</span></span>
<span id="cb24-21"><a href="#cb24-21"></a><span class="co">## indus, rm, age, dis, ptratio, b, lstat</span></span>
<span id="cb24-22"><a href="#cb24-22"></a><span class="co">## </span></span>
<span id="cb24-23"><a href="#cb24-23"></a><span class="co">## Path to optimum:</span></span>
<span id="cb24-24"><a href="#cb24-24"></a><span class="co">## - Features:    0  Init   :                       Perf = 80.748  Diff: NA  *</span></span>
<span id="cb24-25"><a href="#cb24-25"></a><span class="co">## - Features:    1  Add    : lstat                 Perf = 37.629  Diff: 43.119  *</span></span>
<span id="cb24-26"><a href="#cb24-26"></a><span class="co">## - Features:    2  Add    : rm                    Perf = 32.289  Diff: 5.3397  *</span></span>
<span id="cb24-27"><a href="#cb24-27"></a><span class="co">## - Features:    3  Add    : dis                   Perf = 31.4  Diff: 0.88931  *</span></span>
<span id="cb24-28"><a href="#cb24-28"></a><span class="co">## - Features:    4  Add    : indus                 Perf = 30.321  Diff: 1.0794  *</span></span>
<span id="cb24-29"><a href="#cb24-29"></a><span class="co">## - Features:    5  Add    : ptratio               Perf = 29.775  Diff: 0.54598  *</span></span>
<span id="cb24-30"><a href="#cb24-30"></a><span class="co">## - Features:    6  Add    : b                     Perf = 29.469  Diff: 0.3058  *</span></span>
<span id="cb24-31"><a href="#cb24-31"></a><span class="co">## - Features:    7  Add    : age                   Perf = 29.423  Diff: 0.046036  *</span></span>
<span id="cb24-32"><a href="#cb24-32"></a><span class="co">## </span></span>
<span id="cb24-33"><a href="#cb24-33"></a><span class="co">## Stopped, because no improving feature was found.</span></span></code></pre></div>
</div>
<div id="example-3-one-task-two-learners-feature-filtering-with-tuning" class="section level2">
<h2 class="hasAnchor">
<a href="#example-3-one-task-two-learners-feature-filtering-with-tuning" class="anchor"></a>Example 3: One task, two learners, feature filtering with tuning</h2>
<p>Here is a minimal example for feature filtering with tuning of the feature subset size.</p>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb25-1"><a href="#cb25-1"></a><span class="co"># Feature filtering with tuning in the inner resampling loop</span></span>
<span id="cb25-2"><a href="#cb25-2"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeFilterWrapper.html">makeFilterWrapper</a></span>(<span class="dt">learner =</span> <span class="st">"regr.lm"</span>, <span class="dt">fw.method =</span> <span class="st">"FSelector_chi.squared"</span>)</span>
<span id="cb25-3"><a href="#cb25-3"></a>ps =<span class="st"> </span><span class="kw">makeParamSet</span>(<span class="kw">makeDiscreteParam</span>(<span class="st">"fw.abs"</span>, <span class="dt">values =</span> <span class="kw"><a href="https://rdrr.io/r/base/seq.html">seq_len</a></span>(<span class="kw"><a href="../../reference/getTaskNFeats.html">getTaskNFeats</a></span>(bh.task))))</span>
<span id="cb25-4"><a href="#cb25-4"></a>ctrl =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneControlGrid.html">makeTuneControlGrid</a></span>()</span>
<span id="cb25-5"><a href="#cb25-5"></a>inner =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"CV"</span>, <span class="dt">iter =</span> <span class="dv">2</span>)</span>
<span id="cb25-6"><a href="#cb25-6"></a>lrn =<span class="st"> </span><span class="kw"><a href="../../reference/makeTuneWrapper.html">makeTuneWrapper</a></span>(lrn, <span class="dt">resampling =</span> inner, <span class="dt">par.set =</span> ps, <span class="dt">control =</span> ctrl,</span>
<span id="cb25-7"><a href="#cb25-7"></a>  <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb25-8"><a href="#cb25-8"></a></span>
<span id="cb25-9"><a href="#cb25-9"></a><span class="co"># Learners</span></span>
<span id="cb25-10"><a href="#cb25-10"></a>lrns =<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="st">"regr.rpart"</span>, lrn)</span>
<span id="cb25-11"><a href="#cb25-11"></a></span>
<span id="cb25-12"><a href="#cb25-12"></a><span class="co"># Outer resampling loop</span></span>
<span id="cb25-13"><a href="#cb25-13"></a>outer =<span class="st"> </span><span class="kw"><a href="../../reference/makeResampleDesc.html">makeResampleDesc</a></span>(<span class="st">"Subsample"</span>, <span class="dt">iter =</span> <span class="dv">3</span>)</span>
<span id="cb25-14"><a href="#cb25-14"></a>res =<span class="st"> </span><span class="kw"><a href="../../reference/benchmark.html">benchmark</a></span>(<span class="dt">tasks =</span> bh.task, <span class="dt">learners =</span> lrns, <span class="dt">resampling =</span> outer, <span class="dt">show.info =</span> <span class="ot">FALSE</span>)</span>
<span id="cb25-15"><a href="#cb25-15"></a></span>
<span id="cb25-16"><a href="#cb25-16"></a>res</span>
<span id="cb25-17"><a href="#cb25-17"></a><span class="co">##                 task.id             learner.id mse.test.mean</span></span>
<span id="cb25-18"><a href="#cb25-18"></a><span class="co">## 1 BostonHousing-example             regr.rpart      22.16021</span></span>
<span id="cb25-19"><a href="#cb25-19"></a><span class="co">## 2 BostonHousing-example regr.lm.filtered.tuned      25.77558</span></span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co"># Performances on individual outer test data sets</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="kw"><a href="../../reference/getBMRPerformances.html">getBMRPerformances</a></span>(res, <span class="dt">as.df =</span> <span class="ot">TRUE</span>)</span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">##                 task.id             learner.id iter      mse</span></span>
<span id="cb26-4"><a href="#cb26-4"></a><span class="co">## 1 BostonHousing-example             regr.rpart    1 23.14016</span></span>
<span id="cb26-5"><a href="#cb26-5"></a><span class="co">## 2 BostonHousing-example             regr.rpart    2 29.91067</span></span>
<span id="cb26-6"><a href="#cb26-6"></a><span class="co">## 3 BostonHousing-example             regr.rpart    3 13.42981</span></span>
<span id="cb26-7"><a href="#cb26-7"></a><span class="co">## 4 BostonHousing-example regr.lm.filtered.tuned    1 29.75924</span></span>
<span id="cb26-8"><a href="#cb26-8"></a><span class="co">## 5 BostonHousing-example regr.lm.filtered.tuned    2 31.99704</span></span>
<span id="cb26-9"><a href="#cb26-9"></a><span class="co">## 6 BostonHousing-example regr.lm.filtered.tuned    3 15.57047</span></span></code></pre></div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li>
<a href="#tuning">Tuning</a><ul class="nav nav-pills nav-stacked">
<li><a href="#accessing-the-tuning-result">Accessing the tuning result</a></li>
      </ul>
</li>
      <li>
<a href="#feature-selection">Feature selection</a><ul class="nav nav-pills nav-stacked">
<li>
<a href="#wrapper-methods">Wrapper methods</a><ul class="nav nav-pills nav-stacked">
<li><a href="#accessing-the-selected-features">Accessing the selected features</a></li>
      </ul>
</li>
      <li>
<a href="#filter-methods-with-tuning">Filter methods with tuning</a><ul class="nav nav-pills nav-stacked">
<li><a href="#accessing-the-selected-features-and-optimal-percentage">Accessing the selected features and optimal percentage</a></li>
      </ul>
</li>
      </ul>
</li>
      <li>
<a href="#benchmark-experiments">Benchmark experiments</a><ul class="nav nav-pills nav-stacked">
<li><a href="#example-1-two-tasks-two-learners-tuning">Example 1: Two tasks, two learners, tuning</a></li>
      <li><a href="#example-2-one-task-two-learners-feature-selection">Example 2: One task, two learners, feature selection</a></li>
      <li><a href="#example-3-one-task-two-learners-feature-filtering-with-tuning">Example 3: One task, two learners, feature filtering with tuning</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Bernd Bischl, Michel Lang, Lars Kotthoff, Patrick Schratz, Julia Schiffner, Jakob Richter, Zachary Jones, Giuseppe Casalicchio, Mason Gallo.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  
<script src="https://cdnjs.cloudflare.com/ajax/libs/docsearch.js/2.6.1/docsearch.min.js" integrity="sha256-GKvGqXDznoRYHCwKXGnuchvKSwmx9SRMrZOTh2g4Sb0=" crossorigin="anonymous"></script><script>
  docsearch({
    
    
    apiKey: 'e300ecafdf04fe1199e3339c825ce7d0',
    indexName: 'mlr',
    inputSelector: 'input#search-input.form-control',
    transformData: function(hits) {
      return hits.map(function (hit) {
        hit.url = updateHitURL(hit);
        return hit;
      });
    }
  });
</script>
</body>
</html>
